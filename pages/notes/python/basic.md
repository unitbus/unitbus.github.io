---
layout: default
title: Python
---

<!-- # Python Basic -->

# 全般

## 基本

pythonは、すべての変数、関数がオブジェクトで、ルールが統一されている。
ファイル構成も、クラスもパッケージも、同じ考え方で慣れると色々スッキリする。

オレオレ仕様で頑張っても、正規ルートから外れたルールだといずれ詰む。

## 参考

> [PythonMatrixJp: Pythonのモジュールインポートのしくみ](http://python.matrix.jp/pages/tips/import.html)

# Class

クラスの中で定義された関数は、**クラスメソッド**と呼ぶ。
変数は、**クラスメンバ**と呼ぶ。それぞれ意味は変わらない。

**Class**の構造は、**Package**のファイル構造と同じ。

# Package

インストールディレクトリを見るのが分かりやすい。
`site-packages` は、外部からダウンロードした**Package**を指す。

# 文字列

## 基本

整理中

## エンコード

Pythonで扱う文字列には、`<str>`, `<unicode>`の2つしかない。
`encode`と`decode`とでてくるが、目的は明確。

``` yaml
encode: <unicode>から<str>に変換
decode: <str>から<unicode>に変換
```

Python内すべての文字列操作は、`<unicode>`を推奨してると思ってもいいので、
なるべく`<unicode>`で扱う。なので、`<str>`に変換する事をエンコードと呼ぶと思われ。

エンコードで調べると、色々(`cp932`, `shift_jis`, `utf16`, `utf8`)と出てくるが、
すべて`<str>`に変換する際の形式の話になる。ざっくり総称で、**文字コード**と呼ばれたりする。

`ascii`と言う単語も出てくるが、`<str>`と同意語と思って良いかと。
**Pythonの型**と、**文字コード**は別って事がわかってないと、どのサイトの説明を見ても混乱する。

では、2つしかないのに、なぜあんな面倒でイライラするUnicodeEncodeErrorが頻発するかと言うと、
外部プロセスに渡したり、Python内の自動変更の場合が多い。

注意すべきなのは、以下のとき。

- コンソールに出力
- コマンドで実行、取得
- その他自動変更

### コンソールに出力

print使うときは、`<unicode>`に変換してから行う。実際に出力される文字は`<str>`なのだが、
コンソールの環境によって出力できる文字コードが違うので、自動変換に任せる。

### コマンドで実行、取得

`os.system`, `subprocess`を使う場合は、事前に`<str>`に変換する必要がある。
内部でformat処理されてるので、`<str>`に変換される為と思われる。
※ Python3になると、逆になるかもしれないが、まだ触ってないので未確認

### その他自動変更

`__future__.unicode_literals`環境でformatを使った文字操作で、
`<unicode>`の自動変換が入る(`r`付けた場合も`<unicode>`)。

使用してない場合は、`u`を付けると`<unicode>`へ自動変換される。
逆に、`u`以外はすべて`<str>`になるので注意。

Python3では、デフォルトエンコーディングが`<unicode>`になったので、トラブルは減る気がするが、
Python2のコードそのまま変換すると混乱が起きそうな予感。
特におまじない的に処理書いてる場合は注意。

## 参考

> ikuliの日本語の文字化けに悩まない！【文字コードを攻略しよう】
http://marukentokyo.jp/2018/10/30/sikulix_character/
